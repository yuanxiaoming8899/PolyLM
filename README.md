<div class="Box-sc-g0xbh4-0 bJMeLZ js-snippet-clipboard-copy-unpositioned" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><p align="center" dir="auto">
  <a href="https://huggingface.co/DAMO-NLP-MT/polylm-1.7b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PolyLM-1.7B</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">｜</font></font><a href="https://huggingface.co/DAMO-NLP-MT/polylm-13b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PolyLM-13B</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">｜</font></font><a href="https://huggingface.co/DAMO-NLP-MT/polylm-chat-13b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PolyLM-13B-Chat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">｜</font></font><a href="https://modelscope.cn/studios/damo/demo-polylm-multialpaca-13b/summary" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演示</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">｜ &nbsp;</font></font><a href="https://arxiv.org/pdf/2307.06018.pdf" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论文</font></font></a>
</p>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PolyLM</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一种多语言大语言模型，旨在解决当前LLM研究中的以下空白和限制，为推进该领域提供全面且创新的解决方案。</font></font></p>
<ol dir="auto">
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">涵盖18种最常用语言</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 PolyLM 精通全球主要非英语语言，如西班牙语、俄语、阿拉伯语、日语、韩语、泰语、印度尼西亚语和中文等。它是对现有开源模型的完美补充，包括：（1 ) LLaMA，其中英语在整个数据集中占主导地位。 (2) BLOOM，未能解决大量人口使用的语言，例如日语、韩语和泰语。</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更好的多语言指令跟随能力</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我们建议 MULTIALPACA 来补充 ALPACA 和 CHINESEALPACA，使法学硕士更好地遵循多语言指令，特别是来自非英语母语人士的指令。</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能强劲</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。与模型大小相似的流行多语言法学硕士相比，PolyLM 在各种任务上表现出了出色的性能，包括 QA、理解和生成。</font></font></li>
</ol>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelscope</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Huggingface</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上开源了 PolyLM ，涉及两个尺度（即 1.7B 和 13B）。</font></font></p>
<table>
<thead>
<tr>
<th align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型</font></font></th>
<th align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型范围</font></font></th>
<th align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抱脸</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚LM-1.7B</font></font></strong></td>
<td align="right"><a href="https://modelscope.cn/models/damo/nlp_polylm_1b7_text_generation/summary" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
<td align="right"><a href="https://huggingface.co/DAMO-NLP-MT/polylm-1.7b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
</tr>
<tr>
<td align="left"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚LM-13B</font></font></strong></td>
<td align="right"><a href="https://modelscope.cn/models/damo/nlp_polylm_13b_text_generation/summary" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
<td align="right"><a href="https://huggingface.co/DAMO-NLP-MT/polylm-13b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
</tr>
<tr>
<td align="left"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PolyLM-Multialpaca-13B</font></font></strong></td>
<td align="right"><a href="https://modelscope.cn/models/damo/nlp_polylm_multialpaca_13b_text_generation/summary" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
<td align="right"><a href="https://huggingface.co/DAMO-NLP-MT/polylm-multialpaca-13b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
</tr>
<tr>
<td align="left"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PolyLM-Chat-13B</font></font></strong></td>
<td align="right"><a href="https://www.modelscope.cn/models/damo/nlp_polylm_assistant_13b_text_generation/summary" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
<td align="right"><a href="https://huggingface.co/DAMO-NLP-MT/polylm-chat-13b" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[关联]</font></font></a></td>
</tr>
</tbody>
</table>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用法</font></font></h2><a id="user-content-usage" class="anchor" aria-label="永久链接：用法" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下面是一些有关如何在 Modelscope 和 Transformers 中使用模型的示例脚本。</font></font></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求</font></font></h3><a id="user-content-requirements" class="anchor" aria-label="永久链接：要求" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>git clone https://github.com/modelscope/modelscope
<span class="pl-c1">cd</span> modelscope
pip install <span class="pl-c1">.</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="git clone https://github.com/modelscope/modelscope
cd modelscope
pip install ." tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>pip install transformers==4.31.0 accelerate einops</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="pip install transformers==4.31.0 accelerate einops" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变形金刚</font></font></h3><a id="user-content-transformers" class="anchor" aria-label="永久链接：变形金刚" href="#transformers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有使用 PolyLM-13B、PolyLM-Multialpaca-13B 和 PolyLM-Chat-13B 进行推理的示例脚本。</font></font></p>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">transformers</span> <span class="pl-k">import</span> <span class="pl-v">AutoModelForCausalLM</span>, <span class="pl-v">AutoTokenizer</span>

<span class="pl-c"># PolyLM-1.7B</span>
<span class="pl-c"># model_path = "DAMO-NLP-MT/polylm-1.7b"</span>
<span class="pl-c"># PolyLM-13B</span>
<span class="pl-s1">model_path</span> <span class="pl-c1">=</span> <span class="pl-s">"DAMO-NLP-MT/polylm-13b"</span>
<span class="pl-c"># PolyLM-Multialpaca-13B</span>
<span class="pl-c"># model_path = "DAMO-NLP-MT/polylm-multialpaca-13b"</span>
<span class="pl-c"># PolyLM-Chat-13B</span>
<span class="pl-c"># model_path = "DAMO-NLP-MT/polylm-chat-13b"</span>

<span class="pl-s1">tokenizer</span> <span class="pl-c1">=</span> <span class="pl-v">AutoTokenizer</span>.<span class="pl-en">from_pretrained</span>(<span class="pl-s1">model_path</span>, <span class="pl-s1">legacy</span><span class="pl-c1">=</span><span class="pl-c1">False</span>, <span class="pl-s1">use_fast</span><span class="pl-c1">=</span><span class="pl-c1">False</span>)
<span class="pl-s1">model</span> <span class="pl-c1">=</span> <span class="pl-v">AutoModelForCausalLM</span>.<span class="pl-en">from_pretrained</span>(<span class="pl-s1">model_path</span>, <span class="pl-s1">device_map</span><span class="pl-c1">=</span><span class="pl-s">"auto"</span>, <span class="pl-s1">trust_remote_code</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)
<span class="pl-s1">model</span>.<span class="pl-en">eval</span>()

<span class="pl-c"># PolyLM-13B/PolyLM-1.7B</span>
<span class="pl-s1">input_doc</span> <span class="pl-c1">=</span> <span class="pl-s">f"Beijing is the capital of China.<span class="pl-cce">\n</span>Translate this sentence from English to Chinese."</span>
<span class="pl-c"># PolyLM-Multialpaca-13B</span>
<span class="pl-c"># input_doc = f"Beijing is the capital of China.\nTranslate this sentence from English to Chinese.\n\n"</span>
<span class="pl-c"># PolyLM-Chat-13B</span>
<span class="pl-c"># input_doc = f"Beijing is the capital of China.\nTranslate this sentence from English to Chinese."</span>
<span class="pl-c"># input_doc = "&lt;|user|&gt;\n" + f"{input_doc}\n" + "&lt;|assistant|&gt;\n"</span>

<span class="pl-s1">inputs</span> <span class="pl-c1">=</span> <span class="pl-en">tokenizer</span>(<span class="pl-s1">input_doc</span>, <span class="pl-s1">return_tensors</span><span class="pl-c1">=</span><span class="pl-s">"pt"</span>)

<span class="pl-s1">generate_ids</span> <span class="pl-c1">=</span> <span class="pl-s1">model</span>.<span class="pl-en">generate</span>(
  <span class="pl-s1">inputs</span>.<span class="pl-s1">input_ids</span>,
  <span class="pl-s1">attention_mask</span><span class="pl-c1">=</span><span class="pl-s1">inputs</span>.<span class="pl-s1">attention_mask</span>,
  <span class="pl-s1">do_sample</span><span class="pl-c1">=</span><span class="pl-c1">False</span>,
  <span class="pl-s1">num_beams</span><span class="pl-c1">=</span><span class="pl-c1">4</span>,
  <span class="pl-s1">max_length</span><span class="pl-c1">=</span><span class="pl-c1">128</span>,
  <span class="pl-s1">early_stopping</span><span class="pl-c1">=</span><span class="pl-c1">True</span>
)

<span class="pl-s1">decoded</span> <span class="pl-c1">=</span> <span class="pl-s1">tokenizer</span>.<span class="pl-en">batch_decode</span>(<span class="pl-s1">generate_ids</span>, <span class="pl-s1">skip_special_tokens</span><span class="pl-c1">=</span><span class="pl-c1">True</span>, <span class="pl-s1">clean_up_tokenization_spaces</span><span class="pl-c1">=</span><span class="pl-c1">False</span>)[<span class="pl-c1">0</span>]
<span class="pl-en">print</span>(<span class="pl-s">f"&gt;&gt;&gt; <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">decoded</span><span class="pl-kos">}</span></span>"</span>)
<span class="pl-c">### results</span>
<span class="pl-c">### Beijing is the capital of China.\nTranslate this sentence from English to Chinese.\\n北京是中华人民共和国的首都。\n ...</span></pre><div class="zeroclipboard-container">
   
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型范围</font></font></h3><a id="user-content-modelscope" class="anchor" aria-label="永久链接：模型范围" href="#modelscope"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">modelscope</span>.<span class="pl-s1">pipelines</span> <span class="pl-k">import</span> <span class="pl-s1">pipeline</span>
<span class="pl-k">from</span> <span class="pl-s1">modelscope</span>.<span class="pl-s1">utils</span>.<span class="pl-s1">constant</span> <span class="pl-k">import</span> <span class="pl-v">Tasks</span>
<span class="pl-k">from</span> <span class="pl-s1">modelscope</span> <span class="pl-k">import</span> <span class="pl-s1">snapshot_download</span>

<span class="pl-c"># PolyLM-13B</span>
<span class="pl-s1">model_id</span> <span class="pl-c1">=</span> <span class="pl-s">'damo/nlp_polylm_13b_text_generation'</span>
<span class="pl-s1">revision</span> <span class="pl-c1">=</span> <span class="pl-s">'v1.0.3'</span>

<span class="pl-c"># PolyLM-Multialpaca-13B</span>
<span class="pl-c"># model_id = 'damo/nlp_polylm_multialpaca_13b_text_generation'</span>
<span class="pl-c"># revision = 'v1.0.0'</span>

<span class="pl-c"># PolyLM-Chat-13B</span>
<span class="pl-c"># model_id = 'damo/nlp_polylm_assistant_13b_text_generation'</span>
<span class="pl-c"># revision = 'v1.0.0'</span>

<span class="pl-s1">model_dir</span> <span class="pl-c1">=</span> <span class="pl-en">snapshot_download</span>(<span class="pl-s1">model_id</span>, <span class="pl-s1">revision</span>)

<span class="pl-c"># PolyLM-13B/PolyLM-1.7B</span>
<span class="pl-s1">input_text</span> <span class="pl-c1">=</span> <span class="pl-s">f"Beijing is the capital of China.<span class="pl-cce">\n</span>Translate this sentence from English to Chinese."</span>
<span class="pl-c"># PolyLM-Multialpaca-13B</span>
<span class="pl-c"># input_text = f"Beijing is the capital of China.\nTranslate this sentence from English to Chinese.\n\n"</span>
<span class="pl-c"># PolyLM-Chat-13B</span>
<span class="pl-c"># input_text = f"Beijing is the capital of China.\nTranslate this sentence from English to Chinese."</span>
<span class="pl-c"># input_text = "&lt;|user|&gt;\n" + f"{input_text}\n" + "&lt;|assistant|&gt;\n"</span>

<span class="pl-s1">kwargs</span> <span class="pl-c1">=</span> {<span class="pl-s">"do_sample"</span>: <span class="pl-c1">False</span>, <span class="pl-s">"num_beams"</span>: <span class="pl-c1">4</span>, <span class="pl-s">"max_new_tokens"</span>: <span class="pl-c1">128</span>, <span class="pl-s">"early_stopping"</span>: <span class="pl-c1">True</span>, <span class="pl-s">"eos_token_id"</span>: <span class="pl-c1">2</span>}
<span class="pl-s1">pipeline_ins</span> <span class="pl-c1">=</span> <span class="pl-en">pipeline</span>(<span class="pl-v">Tasks</span>.<span class="pl-s1">text_generation</span>, <span class="pl-s1">model</span><span class="pl-c1">=</span><span class="pl-s1">model_dir</span>)

<span class="pl-s1">result</span> <span class="pl-c1">=</span> <span class="pl-en">pipeline_ins</span>(<span class="pl-s1">input_text</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>)
<span class="pl-en">print</span>(<span class="pl-s1">result</span>[<span class="pl-s">'text'</span>])</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from modelscope.pipelines import pipeline
from modelscope.utils.constant import Tasks
from modelscope import snapshot_download

# PolyLM-13B
model_id = 'damo/nlp_polylm_13b_text_generation'
revision = 'v1.0.3'

# PolyLM-Multialpaca-13B
# model_id = 'damo/nlp_polylm_multialpaca_13b_text_generation'
# revision = 'v1.0.0'

# PolyLM-Chat-13B
# model_id = 'damo/nlp_polylm_assistant_13b_text_generation'
# revision = 'v1.0.0'

model_dir = snapshot_download(model_id, revision)

# PolyLM-13B/PolyLM-1.7B
input_text = f&quot;Beijing is the capital of China.\nTranslate this sentence from English to Chinese.&quot;
# PolyLM-Multialpaca-13B
# input_text = f&quot;Beijing is the capital of China.\nTranslate this sentence from English to Chinese.\n\n&quot;
# PolyLM-Chat-13B
# input_text = f&quot;Beijing is the capital of China.\nTranslate this sentence from English to Chinese.&quot;
# input_text = &quot;<|user|>\n&quot; + f&quot;{input_text}\n&quot; + &quot;<|assistant|>\n&quot;

kwargs = {&quot;do_sample&quot;: False, &quot;num_beams&quot;: 4, &quot;max_new_tokens&quot;: 128, &quot;early_stopping&quot;: True, &quot;eos_token_id&quot;: 2}
pipeline_ins = pipeline(Tasks.text_generation, model=model_dir)

result = pipeline_ins(input_text, **kwargs)
print(result['text'])" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演示</font></font></h2><a id="user-content-demo" class="anchor" aria-label="永久链接：演示" href="#demo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们提供了</font><font style="vertical-align: inherit;">基于gradio的网页</font></font><a href="https://modelscope.cn/studios/damo/demo-polylm-multialpaca-13b/summary" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">供大家体验。同样，您可以运行</font></font><a href="https://huggingface.co/DAMO-NLP-MT/polylm-chat-13b/blob/main/polylm_web_demo_gradio.py" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">polylm_web_demo_gradio.py</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本地部署Web演示（需要48GB GPU内存，即2个V100 GPU或单个A100 GPU）。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许可协议</font></font></h2><a id="user-content-license-agreement" class="anchor" aria-label="永久链接：许可协议" href="#license-agreement"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究人员和开发人员可以自由使用PolyLM-1.7B、PolyLM-13B、PolyLM-Multialpaca-13B和PolyLM-Chat-13B的代码和模型权重。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比布泰克斯</font></font></h2><a id="user-content-bibtex" class="anchor" aria-label="永久链接： Bibtex" href="#bibtex"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-text-bibtex notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">@misc</span>{<span class="pl-en">wei2023polylm</span>,
      <span class="pl-s">title</span>=<span class="pl-s"><span class="pl-pds">{</span>PolyLM: An Open Source Polyglot Large Language Model<span class="pl-pds">}</span></span>, 
      <span class="pl-s">author</span>=<span class="pl-s"><span class="pl-pds">{</span>Xiangpeng Wei and Haoran Wei and Huan Lin and Tianhao Li and Pei Zhang and Xingzhang Ren and Mei Li and Yu Wan and Zhiwei Cao and Binbin Xie and Tianxiang Hu and Shangjie Li and Binyuan Hui and Bowen Yu and Dayiheng Liu and Baosong Yang and Fei Huang and Jun Xie<span class="pl-pds">}</span></span>,
      <span class="pl-s">year</span>=<span class="pl-s"><span class="pl-pds">{</span>2023<span class="pl-pds">}</span></span>,
      <span class="pl-s">eprint</span>=<span class="pl-s"><span class="pl-pds">{</span>2307.06018<span class="pl-pds">}</span></span>,
      <span class="pl-s">archivePrefix</span>=<span class="pl-s"><span class="pl-pds">{</span>arXiv<span class="pl-pds">}</span></span>,
      <span class="pl-s">primaryClass</span>=<span class="pl-s"><span class="pl-pds">{</span>cs.CL<span class="pl-pds">}</span></span>
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="@misc{wei2023polylm,
      title={PolyLM: An Open Source Polyglot Large Language Model}, 
      author={Xiangpeng Wei and Haoran Wei and Huan Lin and Tianhao Li and Pei Zhang and Xingzhang Ren and Mei Li and Yu Wan and Zhiwei Cao and Binbin Xie and Tianxiang Hu and Shangjie Li and Binyuan Hui and Bowen Yu and Dayiheng Liu and Baosong Yang and Fei Huang and Jun Xie},
      year={2023},
      eprint={2307.06018},
      archivePrefix={arXiv},
      primaryClass={cs.CL}
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</article></div>
